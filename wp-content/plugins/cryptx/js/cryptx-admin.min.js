!function(e){e(function(){e(".color-field").wpColorPicker()});var t,i,d,a=e("#opt_linktext4"),o=e("#opt_linktext4_notice"),n=e("#image_attachment_id"),s=e("#image-preview"),l=e("#upload_image_button"),r=e("#remove_image_button"),p=e("#opt_linktext");function c(){0==n.val()?(1==a.prop("checked")&&(a.prop("checked",!1),p.prop("checked",!0)),a.prop("disabled",!0),o.removeClass("hidden"),s.addClass("hidden"),l.removeClass("hidden"),r.addClass("hidden")):(a.prop("disabled",!1),o.addClass("hidden"),s.removeClass("hidden"),l.addClass("hidden"),r.removeClass("hidden"))}c(),n.on("change",function(){c()}),l.on("click",function(e){var a;if(e.preventDefault(),d=n.val(),t)return i=wp.media.model.settings.post.id,t.uploader.uploader.param("post_id",d),void t.open();wp.media.model.settings.post.id=d,(t=wp.media.frames.file_frame=wp.media({title:"Select a image to upload",button:{text:"Use this image"},multiple:!1})).on("select",function(){a=t.state().get("selection").first().toJSON(),s.attr("src",a.url).css("width","auto"),n.val(a.id),n.trigger("change"),wp.media.model.settings.post.id=i}),t.open()}),e("a.add_media").on("click",function(){wp.media.model.settings.post.id=i}),r.on("click",function(e){e.preventDefault(),s.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="),l.removeClass("hidden"),r.addClass("hidden"),n.val("0").trigger("change")})}(jQuery);